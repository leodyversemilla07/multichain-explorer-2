{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="mb-8">
        <nav class="text-sm text-gray-600 mb-4">
            <a href="{{ base_url }}" class="hover:text-blue-600">Home</a>
            <span class="mx-2">/</span>
            <a href="{{ base_url }}{{ chain_path }}" class="hover:text-blue-600">{{ chain_name }}</a>
            <span class="mx-2">/</span>
            <a href="{{ base_url }}{{ chain_path }}/asset/{{ asset_name }}" class="hover:text-blue-600">{{ asset_name }}</a>
            <span class="mx-2">/</span>
            <span class="text-gray-900">Issuances</span>
        </nav>

        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">Asset Issuances</h1>
                <p class="mt-2 text-gray-600">Issuance history for: <span class="font-semibold">{{ asset_name }}</span></p>
            </div>
            <span class="text-sm text-gray-600">{{ pagination.total|default(0) }} issuances</span>
        </div>
    </div>

    <!-- Issuances List -->
    {% if issuances and issuances|length > 0 %}
    <div class="space-y-4">
        {% for issue in issuances %}
        <div class="bg-white rounded-lg shadow">
            <div class="px-6 py-4 bg-gray-50 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <span class="px-3 py-1 text-sm font-medium rounded-full
                                     {% if loop.first %}bg-green-100 text-green-800
                                     {% else %}bg-blue-100 text-blue-800{% endif %}">
                            {{ 'Initial Issue' if loop.first else 'Reissuance' }}
                        </span>

                        {% if issue.confirmations is defined %}
                        <span class="text-sm text-gray-500">{{ issue.confirmations }} confirmations</span>
                        {% endif %}
                    </div>

                    <div class="text-sm text-gray-500">
                        {% if issue.time %}
                        {{ issue.time|format_timestamp }}
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="px-6 py-4">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Issuer -->
                    <div>
                        <p class="text-sm font-medium text-gray-500">Issuer</p>
                        <a href="{{ base_url }}{{ chain_path }}/address/{{ issue.issuer }}"
                           class="text-sm text-blue-600 hover:text-blue-800 font-mono break-all">
                            {{ issue.issuer }}
                        </a>
                    </div>

                    <!-- Quantity -->
                    <div>
                        <p class="text-sm font-medium text-gray-500">Quantity Issued</p>
                        <p class="text-xl font-bold text-gray-900">{{ issue.qty|format_amount }}</p>
                    </div>

                    <!-- Transaction -->
                    <div>
                        <p class="text-sm font-medium text-gray-500">Transaction</p>
                        <a href="{{ base_url }}{{ chain_path }}/tx/{{ issue.txid }}"
                           class="text-sm text-blue-600 hover:text-blue-800 font-mono">
                            {{ issue.txid|format_hash(16) }}
                        </a>
                    </div>
                </div>

                {% if issue.details %}
                <div class="mt-4 pt-4 border-t border-gray-200">
                    <p class="text-sm font-medium text-gray-500 mb-2">Details</p>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <pre class="text-sm text-gray-700 whitespace-pre-wrap">{{ issue.details }}</pre>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if pagination %}
    <div class="mt-8">
        {% include 'components/pagination.html' %}
    </div>
    {% endif %}

    {% else %}
    <!-- Empty State -->
    <div class="bg-white rounded-lg shadow p-12 text-center">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
        </svg>
        <h3 class="mt-2 text-sm font-medium text-gray-900">No issuances</h3>
        <p class="mt-1 text-sm text-gray-500">No issuance history available for this asset.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
